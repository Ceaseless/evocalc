/*
   HR1/PR1
   HR100
   GR
   Z
*/
const normalPoints = [
    [0, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300, 320, 340, 360, 380, 400, 420, 440, 460, 480, 500, 520, 540, 560, 580, 600, 620, 640, 660, 680, 700, 720, 740, 760, 780, 800, 820, 840, 860, 880, 900, 920, 940, 960, 980, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950, 2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3200, 3400, 3600, 3800, 4000, 4500, 5000, 5500, 6000, 7000, 8000, 9000, 10000, 11000, 12000, 13000, 14000, 15000, 17000, 20000], // State 1
    [0, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000, 4200, 4400, 4600, 4800, 5000, 5200, 5400, 5600, 5800, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 12000, 13000, 14000, 15000, 16000, 17000, 18000, 19000, 20000, 21000, 22000, 23000, 24000, 25000, 26000, 27000, 28000, 29000, 30000, 31000, 32000, 33000, 34000, 35000, 36000, 37000, 38000, 39000, 40000, 41000, 42000, 43000, 44000, 45000, 46000, 47000, 48000, 49000, 50000, 60000], // State 2
    [0, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 100000, 100000, 100000, 100000, 120000, 120000, 120000, 150000, 150000, 200000],
    [1000000, 100000, 100000, 100000, 125000, 125000, 125000, 125000, 125000, 150000, 150000, 150000, 150000, 150000, 175000, 175000, 175000, 175000, 175000, 200000, 200000, 200000, 200000, 200000, 225000, 225000, 225000, 225000, 225000, 250000, 250000, 250000, 250000, 250000, 275000, 275000, 275000, 275000, 275000, 300000, 300000, 300000, 300000, 300000, 325000, 325000, 325000, 325000, 325000, 350000, 350000, 350000, 350000, 350000, 400000, 400000, 400000, 400000, 400000, 450000, 450000, 450000, 450000, 450000, 500000, 500000, 500000, 500000, 500000, 600000, 600000, 600000, 600000, 600000, 700000, 700000, 700000, 700000, 700000, 800000, 800000, 800000, 800000, 800000, 900000, 900000, 900000, 900000, 900000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 3000000]  // State 4
];

const premiumPoints = [
    [0, 23, 26, 30, 33, 40, 46, 53, 60, 66, 73, 80, 86, 93, 100, 106, 113, 120, 126, 133, 140, 146, 153, 160, 166, 173, 180, 186, 193, 200, 206, 213, 220, 226, 233, 240, 246, 253, 260, 266, 273, 280, 286, 293, 300, 306, 313, 320, 326, 333, 350, 366, 383, 400, 416, 433, 450, 466, 483, 500, 516, 533, 550, 566, 583, 600, 616, 633, 650, 666, 700, 733, 766, 800, 833, 866, 900, 933, 966, 1000, 1066, 1133, 1200, 1266, 1333, 1500, 1666, 1833, 2000, 2333, 2666, 3000, 3333, 3666, 4000, 4333, 4666, 5000, 5666, 6666], // State 3
    [0, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000, 4200, 4400, 4600, 4800, 5000, 5200, 5400, 5600, 5800, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 12000, 13000, 14000, 15000, 16000, 17000, 18000, 19000, 20000, 21000, 22000, 23000, 24000, 25000, 26000, 27000, 28000, 29000, 30000, 31000, 32000, 33000, 34000, 35000, 36000, 37000, 38000, 39000, 40000, 41000, 42000, 43000, 44000, 45000, 46000, 47000, 48000, 49000, 50000, 60000], // State 2
    [0, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 50000, 100000, 100000, 100000, 100000, 120000, 120000, 120000, 150000, 150000, 200000],
    [1000000, 100000, 100000, 100000, 125000, 125000, 125000, 125000, 125000, 150000, 150000, 150000, 150000, 150000, 175000, 175000, 175000, 175000, 175000, 200000, 200000, 200000, 200000, 200000, 225000, 225000, 225000, 225000, 225000, 250000, 250000, 250000, 250000, 250000, 275000, 275000, 275000, 275000, 275000, 300000, 300000, 300000, 300000, 300000, 325000, 325000, 325000, 325000, 325000, 350000, 350000, 350000, 350000, 350000, 400000, 400000, 400000, 400000, 400000, 450000, 450000, 450000, 450000, 450000, 500000, 500000, 500000, 500000, 500000, 600000, 600000, 600000, 600000, 600000, 700000, 700000, 700000, 700000, 700000, 800000, 800000, 800000, 800000, 800000, 900000, 900000, 900000, 900000, 900000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 3000000]  // State 4
];


const dpgPointValue = 100;
const dpgBatchSize = 999;
const rdpPricePerBatch = 7500;
const bcPricePerBatch = 2200;


function getGlobalIndex(state, level) {
    return state * 100 + level;
}

function getPointsAt(globalIndex, tierPoints) {
    const tier = Math.floor(globalIndex / 100);
    const level = globalIndex % 100;
    return tierPoints[tier][level];
}

function displayCosts(totalPoints) {
    const bcDiscountFactor = parseFloat(document.getElementById("bcDiscount").value);

    dpg_total = Math.ceil(totalPoints / dpgPointValue);
    batch_total = Math.ceil(dpg_total / dpgBatchSize);
    rdp_cost = batch_total * rdpPricePerBatch;
    bc_cost_base = batch_total * bcPricePerBatch;
    bc_cost_discount = bc_cost_base * (1 - bcDiscountFactor);
    result.innerText = "Points needed: " + totalPoints;
    result.innerText += "\n DPG needed: " + dpg_total;
    result.innerText += "\n Batches needed: " + batch_total;
    result.innerText += "\n RdP cost: " + rdp_cost;
    result.innerText += "\n BC cost: " + bc_cost_discount;
}

function calculatePoints() {

    const startTier = parseInt(document.getElementById("startTier").value);
    const startLevel = parseInt(document.getElementById("startLevel").value);
    const endTier = parseInt(document.getElementById("endTier").value);
    const endLevel = parseInt(document.getElementById("endLevel").value);
    const isPremium = document.getElementById("isPremium").checked;

    const startIndex = getGlobalIndex(startTier, startLevel);
    const endIndex = getGlobalIndex(endTier, endLevel)

    if (startLevel < 1 || endLevel < 1 || startLevel > 100 || endLevel > 100) {
        displayCosts(0);
        return;
    }

    if (endIndex < startIndex) {
        document.getElementById("result").innerText =
            "Current weapon higher than target";
        return;
    }
    const tierPoints = isPremium ? premiumPoints : normalPoints;
    let gTotal = 0;
    for (let i = startIndex; i < endIndex; i++) {
        gTotal += getPointsAt(i, tierPoints);
    }
    displayCosts(gTotal);
}


